<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarketMaster Pro - Integration Example</title>
    
    <!-- 
        IMPORTANT: Script Loading Order
        
        1. Configuration (must be first)
        2. Authentication Manager
        3. HTTP Client
        4. Data Models
        5. API Endpoints
        6. API Integration Helper
        7. Real-time Updates
        8. UI Components
        9. Application Logic
    -->
    
    <!-- Step 1: Configuration -->
    <script src="js/config.js"></script>
    
    <!-- Step 2: Authentication -->
    <script src="js/auth-manager.js"></script>
    
    <!-- Step 3: HTTP Client -->
    <script src="js/http-client.js"></script>
    
    <!-- Step 4: Data Models -->
    <script src="js/models/recommendation-models.js"></script>
    <script src="js/models/news-models.js"></script>
    
    <!-- Step 5: API Endpoints -->
    <script src="js/api/api-endpoints.js"></script>
    
    <!-- Step 6: API Integration Helper -->
    <script src="js/api-integration.js"></script>
    
    <!-- Step 7: Real-time Updates -->
    <script src="js/real-time-updates.js"></script>
    
    <!-- Step 8: UI Components -->
    <script src="js/recommendation-card-system.js"></script>
    <script src="js/recommendation-filter-system.js"></script>
    <script src="js/confidence-accuracy-tracker.js"></script>
    <script src="js/risk-assessment.js"></script>
    <script src="js/user-verification-badges.js"></script>
    <script src="js/content-moderation.js"></script>
    <script src="js/community-forum-integration.js"></script>
    
    <!-- Step 9: Market Correction Detector -->
    <script src="js/market-correction-detector.js"></script>
    
    <!-- Step 10: Application Logic (your existing scan functions) -->
    <script src="js/smart-recommendations.js"></script>
    
    <style>
        /* Add your existing styles here */
        :root {
            --primary-yellow: #FFD700;
            --primary-green: #00FF41;
            --card-black: #1a1a1a;
            --bg-dark: #0a0a0a;
            --text-white: #ffffff;
            --danger: #FF4444;
        }
        
        body {
            background: var(--bg-dark);
            color: var(--text-white);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            color: var(--primary-yellow);
            text-align: center;
            margin-bottom: 30px;
        }
        
        .section {
            background: var(--card-black);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .section h2 {
            color: var(--primary-yellow);
            margin-top: 0;
        }
        
        button {
            background: var(--primary-yellow);
            color: var(--card-black);
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            font-weight: 600;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            opacity: 0.9;
        }
        
        #results {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ MarketMaster Pro - API Integration Example</h1>
        
        <div class="section">
            <h2>Configuration Status</h2>
            <p>Environment: <strong id="env-status">Loading...</strong></p>
            <p>API Base URL: <strong id="api-url">Loading...</strong></p>
            <p>WebSocket URL: <strong id="ws-url">Loading...</strong></p>
            <p>Using Real API: <strong id="real-api-status">Loading...</strong></p>
            <p>Backend Health: <strong id="backend-health">Checking...</strong></p>
        </div>
        
        <div class="section">
            <h2>Test API Endpoints</h2>
            <button onclick="testPoliticiansInvestors()">Politicians & Investors</button>
            <button onclick="testCatalysts()">Catalysts</button>
            <button onclick="testBiotech()">Biotech</button>
            <button onclick="testGrowthStocks()">Growth Stocks</button>
            <button onclick="testOptions()">Options</button>
            <button onclick="testCrypto()">Crypto</button>
            <button onclick="testForex()">Forex</button>
            <button onclick="testNews()">News Analysis</button>
            <button onclick="clearCache()">Clear Cache</button>
        </div>
        
        <div class="section">
            <h2>Results</h2>
            <div id="results">
                <p style="color: #888;">Click a button above to test an API endpoint</p>
            </div>
        </div>
    </div>
    
    <script>
        // Display configuration status
        document.addEventListener('DOMContentLoaded', async function() {
            document.getElementById('env-status').textContent = CONFIG.ENV;
            document.getElementById('api-url').textContent = CONFIG.getBaseURL();
            document.getElementById('ws-url').textContent = CONFIG.getWebSocketURL();
            document.getElementById('real-api-status').textContent = CONFIG.FEATURES.USE_REAL_API ? 'Yes' : 'No (Simulated)';
            
            // Check backend health
            try {
                const healthy = await apiIntegration.checkBackendHealth();
                document.getElementById('backend-health').textContent = healthy ? '‚úÖ Healthy' : '‚ùå Unavailable';
                document.getElementById('backend-health').style.color = healthy ? 'var(--primary-green)' : 'var(--danger)';
            } catch (error) {
                document.getElementById('backend-health').textContent = '‚ùå Error';
                document.getElementById('backend-health').style.color = 'var(--danger)';
            }
        });
        
        // Test functions
        async function testPoliticiansInvestors() {
            showLoading();
            try {
                const data = await apiIntegration.fetchPoliticiansInvestors();
                displayResults('Politicians & Investors', data);
            } catch (error) {
                displayError(error);
            }
        }
        
        async function testCatalysts() {
            showLoading();
            try {
                const data = await apiIntegration.fetchCatalysts();
                displayResults('Catalysts', data);
            } catch (error) {
                displayError(error);
            }
        }
        
        async function testBiotech() {
            showLoading();
            try {
                const data = await apiIntegration.fetchBiotech();
                displayResults('Biotech', data);
            } catch (error) {
                displayError(error);
            }
        }
        
        async function testGrowthStocks() {
            showLoading();
            try {
                const data = await apiIntegration.fetchGrowthStocks();
                displayResults('Growth Stocks', data);
            } catch (error) {
                displayError(error);
            }
        }
        
        async function testOptions() {
            showLoading();
            try {
                const data = await apiIntegration.fetchOptionsRecommendations();
                displayResults('Options', data);
            } catch (error) {
                displayError(error);
            }
        }
        
        async function testCrypto() {
            showLoading();
            try {
                const data = await apiIntegration.fetchCryptoInfrastructure();
                displayResults('Crypto Infrastructure', data);
            } catch (error) {
                displayError(error);
            }
        }
        
        async function testForex() {
            showLoading();
            try {
                const data = await apiIntegration.fetchForexAnalysis();
                displayResults('Forex', data);
            } catch (error) {
                displayError(error);
            }
        }
        
        async function testNews() {
            showLoading();
            try {
                const data = await apiIntegration.fetchNewsAnalysis();
                displayResults('News Analysis', data);
            } catch (error) {
                displayError(error);
            }
        }
        
        function clearCache() {
            apiIntegration.clearCache();
            document.getElementById('results').innerHTML = '<p style="color: var(--primary-green);">‚úÖ Cache cleared successfully</p>';
        }
        
        function showLoading() {
            document.getElementById('results').innerHTML = `
                <div style="text-align: center; padding: 20px;">
                    <div style="
                        border: 4px solid rgba(255, 215, 0, 0.1);
                        border-top: 4px solid var(--primary-yellow);
                        border-radius: 50%;
                        width: 40px;
                        height: 40px;
                        animation: spin 1s linear infinite;
                        margin: 0 auto;
                    "></div>
                    <p style="margin-top: 15px;">Loading...</p>
                </div>
            `;
        }
        
        function displayResults(title, data) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <h3 style="color: var(--primary-yellow);">${title}</h3>
                <p style="color: var(--primary-green);">‚úÖ Loaded ${data.length} items</p>
                <pre style="
                    background: #000;
                    padding: 15px;
                    border-radius: 5px;
                    overflow-x: auto;
                    max-height: 400px;
                    overflow-y: auto;
                ">${JSON.stringify(data, null, 2)}</pre>
            `;
        }
        
        function displayError(error) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <h3 style="color: var(--danger);">‚ùå Error</h3>
                <p style="color: var(--danger);">${error.message}</p>
            `;
        }
    </script>
</body>
</html>
